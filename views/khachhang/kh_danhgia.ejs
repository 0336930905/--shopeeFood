<%- include('../partials/kh_trangdau') %>

  <body>
    <div class="container mt-4">
      <div class="row">
        <div class="col-5">
          <div class="mt-4 ">
            <h2 class="mb-4">Các đánh giá sản phẩm</h2>
            <div class="dshd">
              <h5>Sắp xếp:</h5>
              <a style="--clr: #836fa1" class="dsdg--ss" href="/khachhang/kh_danhgia?sort=low_to_high">
                <span class="button__icon-wrapper">
                  <i class="fa-solid fa-arrow-up-wide-short"></i>
                </span>
                thấp đến cao
              </a>
              <a style="--clr: #7808d0" class="button--hd" href="/khachhang/kh_danhgia?sort=high_to_low">
                <span class="button__icon-wrapper">
                  <i class="fa-solid fa-arrow-up-short-wide"></i>
                </span>
                Cao đến thấp
              </a>
              <a style="--clr: #7808d0" class="button--hd trangthai-huy" href="/khachhang/kh_danhgia?sort=newest">
                <span class="button__icon-wrapper">
                  <i class="fa-solid fa-fire-flame-curved"></i>
                </span>
                Mới nhất
              </a>
            </div>
          </div>
        </div>
        <div class="col-7 chuyendoi">
          <div class="mt-4">
            <h2 class="mb-4">Sản phẩm được quan tâm</h2>
          </div>
        </div>
      </div>
      <div class="row">
        <div class="col-5 ">
          <div class="mt-4 reviews-max-h600">
            <% reviews.forEach((review, index)=> { %>
              <div class="parent mb-4 ">
                <div class="card">
                  <div class="content-box">
                    <img src="/uploads/<%= review.ANH_SP %>" alt="" class="card-title">
                    <p class="card-content">
                      <%= review.TEN_SP %>
                    </p>
                    <div class="rating">
                      <input type="radio" id="star5_<%= index %>" name="rate_<%= index %>" value="5"
                        <%=review.HANG_DG===5 ? 'checked' : '' %> />
                      <label for="star5_<%= index %>"><svg viewBox="0 0 576 512" height="1em">
                          <path
                            d="M316.9 18C311.6 7 300.4 0 288.1 0s-23.4 7-28.8 18L195 150.3 51.4 171.5c-12 1.8-22 10.2-25.7 21.7s-.7 24.2 7.9 32.7L137.8 329 113.2 474.7c-2 12 3 24.2 12.9 31.3s23 8 33.8 2.3l128.3-68.5 128.3 68.5c10.8 5.7 23.9 4.9 33.8-2.3s14.9-19.3 12.9-31.3L438.5 329 542.7 225.9c8.6-8.5 11.7-21.2 7.9-32.7s-13.7-19.9-25.7-21.7L381.2 150.3 316.9 18z">
                          </path>
                        </svg></label>
                      <input type="radio" id="star4_<%= index %>" name="rate_<%= index %>" value="4"
                        <%=review.HANG_DG===4 ? 'checked' : '' %> />
                      <label for="star4_<%= index %>"><svg viewBox="0 0 576 512" height="1em">
                          <path
                            d="M316.9 18C311.6 7 300.4 0 288.1 0s-23.4 7-28.8 18L195 150.3 51.4 171.5c-12 1.8-22 10.2-25.7 21.7s-.7 24.2 7.9 32.7L137.8 329 113.2 474.7c-2 12 3 24.2 12.9 31.3s23 8 33.8 2.3l128.3-68.5 128.3 68.5c10.8 5.7 23.9 4.9 33.8-2.3s14.9-19.3 12.9-31.3L438.5 329 542.7 225.9c8.6-8.5 11.7-21.2 7.9-32.7s-13.7-19.9-25.7-21.7L381.2 150.3 316.9 18z">
                          </path>
                        </svg></label>
                      <input type="radio" id="star3_<%= index %>" name="rate_<%= index %>" value="3"
                        <%=review.HANG_DG===3 ? 'checked' : '' %> />
                      <label for="star3_<%= index %>"><svg viewBox="0 0 576 512" height="1em">
                          <path
                            d="M316.9 18C311.6 7 300.4 0 288.1 0s-23.4 7-28.8 18L195 150.3 51.4 171.5c-12 1.8-22 10.2-25.7 21.7s-.7 24.2 7.9 32.7L137.8 329 113.2 474.7c-2 12 3 24.2 12.9 31.3s23 8 33.8 2.3l128.3-68.5 128.3 68.5c10.8 5.7 23.9 4.9 33.8-2.3s14.9-19.3 12.9-31.3L438.5 329 542.7 225.9c8.6-8.5 11.7-21.2 7.9-32.7s-13.7-19.9-25.7-21.7L381.2 150.3 316.9 18z">
                          </path>
                        </svg></label>
                      <input type="radio" id="star2_<%= index %>" name="rate_<%= index %>" value="2"
                        <%=review.HANG_DG===2 ? 'checked' : '' %> />
                      <label for="star2_<%= index %>"><svg viewBox="0 0 576 512" height="1em">
                          <path
                            d="M316.9 18C311.6 7 300.4 0 288.1 0s-23.4 7-28.8 18L195 150.3 51.4 171.5c-12 1.8-22 10.2-25.7 21.7s-.7 24.2 7.9 32.7L137.8 329 113.2 474.7c-2 12 3 24.2 12.9 31.3s23 8 33.8 2.3l128.3-68.5 128.3 68.5c10.8 5.7 23.9 4.9 33.8-2.3s14.9-19.3 12.9-31.3L438.5 329 542.7 225.9c8.6-8.5 11.7-21.2 7.9-32.7s-13.7-19.9-25.7-21.7L381.2 150.3 316.9 18z">
                          </path>
                        </svg></label>
                      <input type="radio" id="star1_<%= index %>" name="rate_<%= index %>" value="1"
                        <%=review.HANG_DG===1 ? 'checked' : '' %> />
                      <label for="star1_<%= index %>"><svg viewBox="0 0 576 512" height="1em">
                          <path
                            d="M316.9 18C311.6 7 300.4 0 288.1 0s-23.4 7-28.8 18L195 150.3 51.4 171.5c-12 1.8-22 10.2-25.7 21.7s-.7 24.2 7.9 32.7L137.8 329 113.2 474.7c-2 12 3 24.2 12.9 31.3s23 8 33.8 2.3l128.3-68.5 128.3 68.5c10.8 5.7 23.9 4.9 33.8-2.3s14.9-19.3 12.9-31.3L438.5 329 542.7 225.9c8.6-8.5 11.7-21.2 7.9-32.7s-13.7-19.9-25.7-21.7L381.2 150.3 316.9 18z">
                          </path>
                        </svg></label>
                    </div>
                    <span class="see-more">Xem thêm</span> 
                  </div>
                  <div class="date-box">
                    <span class="month">
                      <%= review.NGAY_DG.toLocaleDateString('vi-VN') %>
                    </span>
                  </div>
                </div>
                <div class="modal--dg">
                  <div class="modal--dg-content">
                    <p>Khách hàng: <%= review.TEN_KH %>
                    </p>
                    <p>
                      <%= review.BINHLUAN_DG %>
                    </p>
                  </div>
                </div>
              </div>
              <% }) %>
          </div>
        </div>
        <div class="col-7">
          <div class="mt-4 display-flex">
            <% if (topRatedProducts.length> 0) { %>
              <% const product=topRatedProducts[1]; %>
                <div class="card--h background-color--do" style="margin-top: 20px;">
                  <div class="rectangle left-top"></div>
                  <div class="rectangle right-top"></div>
                  <div class="rectangle left-bottom"></div>
                  <div class="rectangle right-bottom"></div>
                  <img src="/uploads/<%= product.ANH_SP %>" alt="" class="card-title--h">
                  <div class="love">
                    <svg viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" class="svg">
                      <path
                        d="M47.6 300.4L228.3 469.1c7.5 7 17.4 10.9 27.7 10.9s20.2-3.9 27.7-10.9L464.4 300.4c30.4-28.3 47.6-68 47.6-109.5v-5.8c0-69.9-50.5-129.5-119.4-141C347 36.5 300.6 51.4 268 84L256 96 244 84c-32.6-32.6-79-47.5-124.6-39.9C50.5 55.6 0 115.2 0 185.1v5.8c0 41.5 17.2 81.2 47.6 109.5z">
                      </path>
                    </svg>
                    <span>
                      <%= product.SO_LUONG_DANH_GIA %>
                    </span>
                  </div>
                  <div class="category">
                    <button class="button" disabled>
                      <%= product.TEN_SP %>
                    </button>
                  </div>
                  <a href="http://localhost:3000/khachhang/kh_sanpham" class="action"><span>
                    Mua ngay
                  </span></a>
                  <div class="date-box--h2">
                    <span class="month">
                      Hạng 2
                    </span>
                  </div>
                </div>
                <% } %>
                  <% if (topRatedProducts.length> 0) { %>
                    <% const product=topRatedProducts[0]; %>
                      <div class="card--h background-color--tim">
                        <div class="rectangle left-top"></div>
                        <div class="rectangle right-top"></div>
                        <div class="rectangle left-bottom"></div>
                        <div class="rectangle right-bottom"></div>
                        <img src="/uploads/<%= product.ANH_SP %>" alt="" class="card-title--h">
                        <div class="love">
                          <svg viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" class="svg">
                            <path
                              d="M47.6 300.4L228.3 469.1c7.5 7 17.4 10.9 27.7 10.9s20.2-3.9 27.7-10.9L464.4 300.4c30.4-28.3 47.6-68 47.6-109.5v-5.8c0-69.9-50.5-129.5-119.4-141C347 36.5 300.6 51.4 268 84L256 96 244 84c-32.6-32.6-79-47.5-124.6-39.9C50.5 55.6 0 115.2 0 185.1v5.8c0 41.5 17.2 81.2 47.6 109.5z">
                            </path>
                          </svg>
                          <span>
                            <%= product.SO_LUONG_DANH_GIA %>
                          </span>
                        </div>
                        <div class="category">
                          <button class="button" disabled>
                            <%= product.TEN_SP %>
                          </button>
                        </div>
                        <a href="http://localhost:3000/khachhang/kh_sanpham" class="action"><span>
                          Mua ngay
                        </span></a>
                        <div class="date-box--h2">
                          <span class="month">
                            Hạng 1
                          </span>
                        </div>
                      </div>
                      <% } %>
                        <% if (topRatedProducts.length> 0) { %>
                          <% const product=topRatedProducts[2]; %>
                            <div class="card--h background-color--timnhat" style="margin-top: 20px;">
                              <div class="rectangle left-top"></div>
                              <div class="rectangle right-top"></div>
                              <div class="rectangle left-bottom"></div>
                              <div class="rectangle right-bottom"></div>
                              <img src="/uploads/<%= product.ANH_SP %>" alt="" class="card-title--h">
                              <div class="love">
                                <svg viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" class="svg">
                                  <path
                                    d="M47.6 300.4L228.3 469.1c7.5 7 17.4 10.9 27.7 10.9s20.2-3.9 27.7-10.9L464.4 300.4c30.4-28.3 47.6-68 47.6-109.5v-5.8c0-69.9-50.5-129.5-119.4-141C347 36.5 300.6 51.4 268 84L256 96 244 84c-32.6-32.6-79-47.5-124.6-39.9C50.5 55.6 0 115.2 0 185.1v5.8c0 41.5 17.2 81.2 47.6 109.5z">
                                  </path>
                                </svg>
                                <span>
                                  <%= product.SO_LUONG_DANH_GIA %>
                                </span>
                              </div>
                              <div class="category">
                                <button class="button" disabled>
                                  <%= product.TEN_SP %>
                                </button>
                              </div>
                              <a href="http://localhost:3000/khachhang/kh_sanpham" class="action"><span>
                                Mua ngay
                              </span></a>
                              <div class="date-box--h2">
                                <span class="month">
                                  Hạng 3
                                </span>
                              </div>
                            </div>
                            <% } %>
          </div>
          <hr class="card--h--hr">
          <div class="main-cloud">
            <div class="container--cloud">
              <div class="cloud"></div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </body>
  <script>
    document.querySelectorAll('.see-more').forEach(button => {
      button.addEventListener('click', function () {
        const parent = this.closest('.parent');
        const modal = parent.querySelector('.modal--dg');
        modal.classList.toggle('show');
      });
    });
    function ramdomText() {
      var text = "qusadwqocnjgadstuqonxaklz,,_=-da1231!@#$%^&&#@$^&*@@$()%)_+~0235689+630";
      letter = text[Math.floor(Math.random() * text.length)];
      return letter;
    }
    function rain() {
      let cloud = document.querySelector(".cloud")
      let e = document.createElement("div");
      let left = Math.floor(Math.random() * 310);
      let size = Math.random() * 1.5;
      let duration = Math.random() * 1;
      e.classList.add("text-cloud");
      cloud.appendChild(e);
      e.innerText = ramdomText();
      e.style.left = left + "px";
      e.style.fontSize = 0.5 + size + "em";
      e.style.animationDuration = 1 + duration + "s";
      setTimeout( function () {
        cloud.removeChild(e);
      }, 2000);
    }
    setInterval(function() {
      rain();
    },20);
  </script>
  <%- include('../partials/kh_trangcuoi') %>